{"version":3,"sources":["../src/script.js"],"names":["msgerForm","get","msgerInput","msgerChat","HOST","BOT_MSGS","BOT_IMG","PERSON_IMG","BOT_NAME","PERSON_NAME","global_state","window","localStorage","getItem","undefined","addEventListener","event","preventDefault","msgText","value","appendMessage","submitMessage","name","img","side","text","msgHTML","formatDate","Date","insertAdjacentHTML","scrollTop","botResponse","r","random","length","delay","split","setTimeout","state","context","getContext","makeAjaxCall","fetch","method","body","JSON","stringify","then","response","json","data","setItem","message","date","getHours","getMinutes","getDay","getMonth","getDate","getYear","selector","root","document","querySelector","h","m","slice","min","max","Math","floor"],"mappings":"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","sourcesContent":["const msgerForm = get(\".msger-inputarea\");\nconst msgerInput = get(\".msger-input\");\nconst msgerChat = get(\".msger-chat\");\nconst HOST = \"35.202.51.79\"\n\nconst BOT_MSGS = [\n  \"Hi, how are you today?\",\n  \"Ohh... I can't understand what you trying to say. Sorry!\",\n  \"I like to play games... But I don't know how to play!\",\n  \"Sorry if my answers are not relevant. :))\",\n  \"I feel sleepy! :(\"\n];\n\n// Icons made by Freepik from www.flaticon.com\nconst BOT_IMG = \"https://image.flaticon.com/icons/svg/327/327779.svg\";\nconst PERSON_IMG = \"https://image.flaticon.com/icons/svg/145/145867.svg\";\nconst BOT_NAME = \"Kat\";\nconst PERSON_NAME = \"Human\";\n\nvar global_state = {\"state\":{\"message\":\"Hello World\"}}\nif (window.localStorage.getItem('user_id') != undefined) {\n  global_state['state']['user_id'] = window.localStorage.getItem('user_id')\n}\n\n\nmsgerForm.addEventListener(\"submit\", event => {\n  event.preventDefault();\n\n  const msgText = msgerInput.value;\n  if (!msgText) return;\n\n  appendMessage(PERSON_NAME, PERSON_IMG, \"right\", msgText);\n  msgerInput.value = \"\";\n  global_state[\"message\"] = msgText\n  submitMessage(global_state);\n});\n\nfunction appendMessage(name, img, side, text) {\n  //   Simple solution for small apps\n  const msgHTML = `\n    <div class=\"msg ${side}-msg\">\n      <div class=\"msg-img\" style=\"background-image: url(${img})\"></div>\n\n      <div class=\"msg-bubble\">\n        <div class=\"msg-info\">\n          <div class=\"msg-info-name\">${name}</div>\n          <div class=\"msg-info-time\">${formatDate(new Date())}</div>\n        </div>\n\n        <div class=\"msg-text\">${text}</div>\n      </div>\n    </div>\n  `;\n\n  msgerChat.insertAdjacentHTML(\"beforeend\", msgHTML);\n  msgerChat.scrollTop += 500;\n}\n\nfunction botResponse() {\n  const r = random(0, BOT_MSGS.length - 1);\n  const msgText = BOT_MSGS[r];\n  const delay = msgText.split(\" \").length * 100;\n\n  setTimeout(() => {\n    appendMessage(BOT_NAME, BOT_IMG, \"left\", msgText);\n  }, delay);\n}\n\nfunction submitMessage(state) {\n  context = getContext()\n  state['context'] = context\n  makeAjaxCall(state)\n}\n\nfunction makeAjaxCall(state) {\n  //fetch('http://127.0.0.1:5000/messages/' + JSON.stringify(state))\n  fetch('http://35.202.51.79:5000/messages', {\n    method:'post',\n    body: JSON.stringify(state)\n  })\n  .then(response => response.json())\n  .then((data) => {\n    global_state = data\n\n    if (data['state']['user_id'] != undefined)\n      {\n        if (data['state']['user_id'] != -1) {\n        window.localStorage.setItem('user_id',data['state']['user_id'])\n      }\n      }\n    appendMessage(BOT_NAME, BOT_IMG, \"left\", data.message)\n  })\n }\n\nfunction getContext() {\n  date = new Date()\n  context =\n  {\n    'hour': date.getHours(),\n    'minute': date.getMinutes(),\n    'dow': date.getDay(),\n    'month': date.getMonth(),\n    'date': date.getDate(),\n    'year': date.getYear(),\n\n  }\n  return context\n}\n\n// Utils\nfunction get(selector, root = document) {\n  return root.querySelector(selector);\n}\n\nfunction formatDate(date) {\n  const h = \"0\" + date.getHours();\n  const m = \"0\" + date.getMinutes();\n\n  return `${h.slice(-2)}:${m.slice(-2)}`;\n}\n\nfunction random(min, max) {\n  return Math.floor(Math.random() * (max - min) + min);\n}\n\n// Send init message on load\nsubmitMessage(global_state)\n"],"file":"script.js"}